import java.io.IOException;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;
import java.util.Random;

public class TestVulnerabilities {

    // Hardcoded password (Rule: S2068)
    private static final String DB_PASSWORD = "P@ssw0rd123";

    public static void main(String[] args) {
        TestVulnerabilities tv = new TestVulnerabilities();
        tv.testSQLInjection("105 OR 1=1");
        tv.testCommandInjection("hello; rm -rf /");
        tv.testWeakRandom();
    }

    // SQL Injection vulnerability (Rule: S2077)
    public void testSQLInjection(String userInput) {
        try {
            Connection conn = DriverManager.getConnection(
                    "jdbc:h2:mem:testdb", "sa", DB_PASSWORD);
            Statement stmt = conn.createStatement();

            // Vulnerable SQL query using user input directly
            String query = "SELECT * FROM users WHERE id = '" + userInput + "'";
            System.out.println("Executing query: " + query);

            ResultSet rs = stmt.executeQuery(query);
            while (rs.next()) {
                System.out.println("User: " + rs.getString("name"));
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    // Command Injection (Rule: S2076)
    public void testCommandInjection(String input) {
        try {
            // Vulnerable: passing user input to OS command
            Runtime.getRuntime().exec("echo " + input);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    // Predictable random numbers (Rule: S2245)
    public void testWeakRandom() {
        Random rand
